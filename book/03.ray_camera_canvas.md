# 3. 광선, 카메라, 캔버스

## 3.1 실습 목표
1. 광선 추적을 통해 랜더링 결과물 이미지의 pixel의 크기 및 비율을 정의할 수 있다.(해상도)
2. 기본적은 카메라의 위치를 설정할 수 있다.
3. 카메라에서 쏘는 광선을 정의한다~

   샬라샬라~~
목표 산출물
![하늘](./img/03_img1.png)


## 3.2.캔버스
캔버스 구조체는 가로, 새로 픽샐 과 종횡비를 맴버로 가집니다.

```c
#ifndef STRUCTURES_H
# define STRUCTURES_H

typedef struct s_vec3 t_vec3;
typedef struct s_vec3 t_point3;
typedef struct s_vec3 t_color3;
/** 추가 **/
typedef struct s_canvas t_canvas;
/*********/

...

/** 추가 **/
struct	s_canvas
{
	int		width; //canvas width
	int		height; //canvas height;
	double	aspect_ratio;
};
/*********/

#endif
```
***코드1 : [include/structures.h] 캔버스 구조체 추가***

캔버스 구조체의 생성하는 생성자 함수를 만들어 봅시다.
인자는 가로, 세로 픽셀을 받고, 함수 내부에서 종횡비를 계산하여 구조체에 저장해줍니다.

```c
#include "scene.h"

t_canvas	canvas(int	width, int height)
{
	t_canvas canvas;

	canvas.width = width;
	canvas.height = height;
	canvas.aspect_ratio = (double)width / (double)height;
	return (canvas);
}

```
***코드2 : [src/canvas.c] 캔버스 생성자 함수 정의***

## 3.2.카메라
카메라 구조체를 정의해줍시다!!

```c
#ifndef STRUCTURES_H
# define STRUCTURES_H

typedef struct s_vec3 t_vec3;
typedef struct s_vec3 t_point3;
typedef struct s_vec3 t_color3;
typedef struct s_canvas t_canvas;
/** 추가 **/
typedef struct s_camera t_camera;
/*********/

...

struct	s_canvas
{
	int		width; //canvas width
	int		height; //canvas height;
	double	aspect_ratio;
};

/** 추가 **/
struct	s_camera
{
	t_point3	orig;  // origin
	double		view_h; // viewport height;
	double		view_w; // viewport width;
	t_vec3		horizontal; // 수평방향 벡터
	t_vec3		vertical; // 수직방향 벡터
	double		focal_len; // focal length;
	t_point3	left_bottom; // lower left corner;
};
/*********/

#endif
```
***코드3 : [include/structures.h] 카메라 구조체 추가***

생성자도 정의해줍시다! 카메라는 캔버스 구조체에 정의된 종횡비를 사용해서, 뷰포트의 가로 세로를 정의합니다.

! 여기서 focal len left_bottom 등 이미지와 함께 개념 설명 필요할듯
```c
#include "scene.h"

t_camera	camera(t_canvas *canvas, t_point3 orig, double view_h, double focal_len)
{
	t_camera	cam;

	cam.orig = orig;
	cam.view_h = view_h;
	cam.view_w = view_h * canvas->aspect_ratio;
	cam.focal_len = focal_len;
	cam.horizontal = vec3(cam.view_w, 0, 0);
	cam.vertical = vec3(0, cam.view_h, 0);
	// 왼쪽 아래 코너점 좌표, origin - horizontal / 2 - vertical / 2 - vec3(0,0,focal_length)
	cam.left_bottom = vminus(vminus(vminus(cam.orig, vdivide(cam.horizontal, 2)),
								vdivide(cam.vertical, 2)), vec3(0, 0, focal_len));
	return (cam);
}
```
***코드4 : [src/camera.c] 카메라 생성자 추가***

## 3.4. 광선

광선은 항상 출발점과 방향을 가진다.
광선 설명 샬라 샬라~

```c
#ifndef STRUCTURES_H
# define STRUCTURES_H

typedef struct s_vec3 t_vec3;
typedef struct s_vec3 t_point3;
typedef struct s_vec3 t_color3;
typedef struct s_ray t_ray;

struct s_vec3
{
	double x;
	double y;
	double z;
};

/** 추가 **/
struct	s_ray
{
	t_point3	orig;
	t_vec3		dir;
};
/********/

#endif
```
***코드1 : [include/structures.h] 광선 구조체 정의***

광선을 생성하는 생성자도 정의해보자~
```c
#include "ray.h"

//ray 생성자
t_ray	ray(t_point3 orig, t_vec3 dir)
{
	t_ray new;

	new.orig = orig;
	new.dir = dir;
	return (new);
}
```
***코드2 : [src/ray.c] 광선 생성자 정의***

ray.h 헤더를 생성해 줍시다.
```c
#ifndef RAY_H
# define RAY_H

# include "structures.h"
# include "utils.h"

t_ray		ray(t_point3 orig, t_vec3 dir);

#endif
```
***코드3 : [include/ray.h] 생성***

